<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Election</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script>
let clubs = ["MSA", "Science Society", "Engineering Club", "Debate Club", "Pharma Society", "Coding Collective"];

function populateClubs() {
  const select = document.getElementById("clubSelect");
  select.innerHTML = "";
  clubs.forEach(club => {
    const option = document.createElement("option");
    option.value = club;
    option.textContent = club;
    select.appendChild(option);
  });
}

function generateCandidateInputs() {
  const num = parseInt(document.getElementById("numCandidates").value);
  const container = document.getElementById("candidatesContainer");
  container.innerHTML = "";
  if (isNaN(num) || num <= 0) return;
  for (let i = 0; i < num; i++) {
    const div = document.createElement("div");
    div.className = "flex space-x-2 mb-2";

    const nameInput = document.createElement("input");
    nameInput.type = "text";
    nameInput.placeholder = "Candidate Name";
    nameInput.className = "flex-1 border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500";

    const missionInput = document.createElement("input");
    missionInput.type = "text";
    missionInput.placeholder = "Candidate Mission Statement";
    missionInput.className = "flex-1 border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500";

    div.appendChild(nameInput);
    div.appendChild(missionInput);
    container.appendChild(div);
  }
}

function createElection() {
  const name = document.getElementById("electionName").value.trim();
  const club = document.getElementById("clubSelect").value;
  const type = document.getElementById("voteType").value.toLowerCase();
  const vision = document.getElementById("vision").value.trim();
  const startDate = document.getElementById("startDate").value;
  const endDate = document.getElementById("endDate").value;

  if (!name || !club || !type || !startDate || !endDate) {
    alert("Please fill in all required fields.");
    return;
  }

  if (new Date(startDate) > new Date(endDate)) {
    alert("Start date cannot be after end date.");
    return;
  }

  const container = document.getElementById("candidatesContainer");
  const inputs = container.querySelectorAll("input");
  const candidates = [];
  for (let i = 0; i < inputs.length; i += 2) {
    const candName = inputs[i].value.trim();
    const candMission = inputs[i + 1].value.trim();
    if (!candName || !candMission) {
      alert("Please fill in all candidate names and mission statements.");
      return;
    }
    candidates.push({ name: candName, mission: candMission });
  }

  if (candidates.length === 0) {
    alert("Please add at least one candidate.");
    return;
  }

  const electionData = {
    title: name,
    club: club,
    voteType: type, // "single", "multiple", "ranked"
    vision: vision,
    startDate: startDate,
    endDate: endDate,
    candidates: candidates
  };

  // Save the election
  sessionStorage.setItem('electionData', JSON.stringify(electionData));
  window.location.href = "mock-vote.html";
}

window.onload = populateClubs;
</script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
<div class="bg-white shadow-lg rounded-2xl p-8 w-full max-w-3xl">
<h1 class="text-3xl font-bold mb-6 text-center text-indigo-700">Create a New Election</h1>

<div class="space-y-4">
  <div>
    <label class="block text-gray-700 font-medium mb-2">Election Name</label>
    <input type="text" id="electionName" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Enter election name">
  </div>

  <div>
    <label class="block text-gray-700 font-medium mb-2">Select Club</label>
    <select id="clubSelect" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></select>
  </div>

  <div class="flex space-x-2">
    <div class="flex-1">
      <label class="block text-gray-700 font-medium mb-2">Start Date</label>
      <input type="date" id="startDate" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
    </div>
    <div class="flex-1">
      <label class="block text-gray-700 font-medium mb-2">End Date</label>
      <input type="date" id="endDate" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
    </div>
  </div>

  <div>
    <label class="block text-gray-700 font-medium mb-2">Number of Candidates</label>
    <input type="number" id="numCandidates" min="1" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Enter number of candidates" oninput="generateCandidateInputs()">
  </div>

  <div id="candidatesContainer"></div>

  <div>
    <label class="block text-gray-700 font-medium mb-2">Type of Vote</label>
    <select id="voteType" class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
      <option value="single">Single Vote</option>
      <option value="multiple">Multiple Choice</option>
      <option value="ranked">Ranked Choice</option>
    </select>
  </div>

  <div>
    <label class="block text-gray-700 font-medium mb-2">Vision Statement (optional)</label>
    <textarea id="vision" rows="3" placeholder="Enter vision statement..." class="w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
  </div>

  <div class="text-center pt-4">
    <button onclick="createElection()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">Create Election</button>
  </div>
</div>
</div>
</body>
</html>
